## **ğŸš€ HÆ¯á»šNG DáºªN SIÃŠU CHI TIáº¾T THIáº¾T Káº¾ API CHO DÃ‚N CODE ğŸš€**

Yo cÃ¡c báº¡n sinh viÃªn IT! Cháº¯c háº³n ai cÅ©ng nghe Ä‘áº¿n API rá»“i Ä‘Ãºng khÃ´ng? NÃ³ nhÆ° kiá»ƒu "ngÆ°á»i phiÃªn dá»‹ch" giÃºp cÃ¡c á»©ng
dá»¥ng "tÃ¡m chuyá»‡n" vá»›i nhau áº¥y. Thiáº¿t káº¿ API ngon ngháº» thÃ¬ app má»›i cháº¡y mÆ°á»£t mÃ , dá»… dÃ¹ng vÃ  khÃ´ng bá»‹ "táº¯c Ä‘Æ°á»ng" giá»¯a
chá»«ng. BÃ i nÃ y mÃ¬nh sáº½ chá»‰ cÃ¡c báº¡n cÃ¡ch thiáº¿t káº¿ API tá»« A Ä‘áº¿n Z, Ä‘áº£m báº£o sau bÃ i nÃ y, cÃ¡c báº¡n sáº½ tá»± tin "cÃ¢n" má»i loáº¡i
API luÃ´n.

---

### **I. API LÃ€ GÃŒ VÃ€ Táº I SAO PHáº¢I QUAN TÃ‚M?**

**API (Application Programming Interface)**, dá»‹ch nÃ´m na lÃ  "Giao diá»‡n láº­p trÃ¬nh á»©ng dá»¥ng", lÃ  táº­p há»£p cÃ¡c quy táº¯c cho
phÃ©p cÃ¡c pháº§n má»m giao tiáº¿p vá»›i nhau. Hiá»ƒu Ä‘Æ¡n giáº£n:

* **VÃ­ dá»¥:** Báº¡n dÃ¹ng app Ä‘áº·t Ä‘á»“ Äƒn, app Ä‘Ã³ gá»­i yÃªu cáº§u Ä‘áº¿n server cá»§a nhÃ  hÃ ng Ä‘á»ƒ láº¥y thÃ´ng tin mÃ³n Äƒn. API chÃ­nh lÃ  "
  cáº§u ná»‘i" giÃºp hai bÃªn nÃ³i chuyá»‡n Ä‘Æ°á»£c vá»›i nhau.
* **Quan trá»ng:** API xá»‹n thÃ¬:
    * **Dá»… dÃ¹ng:** Code nhanh, khÃ´ng pháº£i "váº­t lá»™n" vá»›i nÃ³.
    * **Ngon:** Cháº¡y nhanh, khÃ´ng giáº­t lag.
    * **Dá»… nÃ¢ng cáº¥p:** ThÃªm tÃ­nh nÄƒng má»›i thoáº£i mÃ¡i, khÃ´ng "Ä‘á»¥ng hÃ ng" cÃ¡i cÅ©.
    * **Báº£o máº­t:** Dá»¯ liá»‡u "an toÃ n nhÆ° trong kÃ©t sáº¯t".

---

### **II. NGUYÃŠN Táº®C VÃ€NG TRONG THIáº¾T Káº¾ API (Dá»„ NHá»š NHA!)**

1. **ÄÆ¡n giáº£n nhÆ° Ä‘an rá»• (Simplicity):**
    * **Endpoint Ã­t thÃ´i:** API nÃªn táº­p trung vÃ o chá»©c nÄƒng chÃ­nh, Ä‘á»«ng cÃ³ "tham" quÃ¡ nhiá»u.
    * **TÃªn dá»… hiá»ƒu:** DÃ¹ng tiáº¿ng Anh quen thuá»™c, ai Ä‘á»c cÅ©ng hiá»ƒu.
        * **VÃ­ dá»¥:** `GET /users` (láº¥y danh sÃ¡ch user) thay vÃ¬ `GET /getAllUserInformation`.
    * **Code dá»… Ä‘á»c:** Tham sá»‘, dá»¯ liá»‡u pháº£i rÃµ rÃ ng, dá»… hiá»ƒu nhÆ° Ä‘á»c truyá»‡n tranh.

2. **Nháº¥t quÃ¡n nhÆ° sinh Ä‘Ã´i (Consistency):**
    * **TÃªn "tÃ i nguyÃªn" Ä‘á»“ng Ä‘á»u:**
        * Sá»‘ nhiá»u cho danh sÃ¡ch: `/users`, `/products`.
        * DÃ¹ng HTTP method, khÃ´ng dÃ¹ng tá»« trong URL: (Ä‘Ãºng: `GET /users`, sai: `/getUsers`).
    * **MÃ£ tráº¡ng thÃ¡i HTTP:** NhÆ° kiá»ƒu "cá» bÃ¡o", pháº£i chuáº©n:
        * `200`: ThÃ nh cÃ´ng (OK).
        * `201`: Táº¡o má»›i thÃ nh cÃ´ng (Created).
        * `400`: YÃªu cáº§u sai (Bad Request).
        * `401`: ChÆ°a Ä‘Äƒng nháº­p (Unauthorized).
        * `404`: KhÃ´ng tÃ¬m tháº¥y (Not Found).
        * `500`: Lá»—i server (Internal Server Error).

3. **Linh hoáº¡t nhÆ° cao su (Flexibility):**
    * **Má»Ÿ rá»™ng:** Dá»± trÃ¹ trÆ°á»›c tÆ°Æ¡ng lai:
        * DÃ¹ng trÆ°á»ng tÃ¹y chá»n.
        * DÃ¹ng JSON hoáº·c XML cho dá»… thay Ä‘á»•i.
    * **KhÃ´ng "phÃ¡ game":** Khi thay Ä‘á»•i, API cÅ© váº«n pháº£i cháº¡y tá»‘t.

4. **Báº£o máº­t nhÆ° kÃ©t sáº¯t (Security):**
    * **HTTPS:** MÃ£ hÃ³a dá»¯ liá»‡u truyá»n qua máº¡ng (báº¯t buá»™c!).
    * **XÃ¡c thá»±c vÃ  á»§y quyá»n:** DÃ¹ng JWT hoáº·c OAuth 2.0 (sáº½ nÃ³i rÃµ sau).
    * **Chá»‘ng hacker:**
        * Kiá»ƒm tra Ä‘áº§u vÃ o (input) Ä‘á»ƒ trÃ¡nh SQL Injection.
        * "Cháº·n" XSS.
        * ThÃªm "tÆ°á»ng lá»­a" chá»‘ng DDoS.

5. **Nhanh nhÆ° chá»›p (Performance):**
    * **Tráº£ dá»¯ liá»‡u "vá»«a Ä‘á»§":** Äá»«ng "tham" tráº£ háº¿t, chá»‰ tráº£ cÃ¡i cáº§n thiáº¿t thÃ´i.
    * **PhÃ¢n trang:** Vá»›i danh sÃ¡ch dÃ i, chia nhá» ra: `/users?page=2&limit=20`.
    * **Caching:** "Gom" dá»¯ liá»‡u láº¡i Ä‘á»ƒ láº§n sau láº¥y cho nhanh.

---

### **III. "Báº®T CHÆ¯á»šC" API RESTful (ÄÆ N GIáº¢N MÃ€ CHáº¤T LÆ¯á»¢NG)**

API RESTful lÃ  kiá»ƒu API "hot" nháº¥t hiá»‡n nay. NÃ³ tuÃ¢n theo cÃ¡c quy táº¯c cá»§a REST (Representational State Transfer).

1. **Method HTTP (Äá»™ng tá»« cá»§a API):**

   | Method    | Chá»©c nÄƒng                               | VÃ­ dá»¥               |
                          |-----------|-----------------------------------------|---------------------|
   | `GET`     | Láº¥y thÃ´ng tin                           | `GET /users`        |
   | `POST`    | Táº¡o má»›i                                | `POST /users`       |
   | `PUT`     | Cáº­p nháº­t toÃ n bá»™                        | `PUT /users/123`    |
   | `PATCH`   | Cáº­p nháº­t má»™t pháº§n                       | `PATCH /users/123`  |
   | `DELETE`  | XÃ³a bá»                                 | `DELETE /users/123` |

2. **TÃªn tÃ i nguyÃªn (Danh tá»« cá»§a API):**

    * DÃ¹ng danh tá»«, khÃ´ng dÃ¹ng Ä‘á»™ng tá»«:
        * **ÄÃºng:** `/users`, `/orders/123`.
        * **Sai:** `/getUsers`, `/createOrder`.
    * URL phÃ¢n cáº¥p:
        * Cha - con: `/users/123/orders`.

3. **Tham sá»‘ truy váº¥n:**

    * Lá»c: `GET /users?role=admin`.
    * Sáº¯p xáº¿p: `GET /users?sort=name`.
    * PhÃ¢n trang: `GET /users?page=2&limit=10`.

---

### **IV. PHIÃŠN Báº¢N API (AI Rá»’I CÅ¨NG KHÃC!)**

Khi API thay Ä‘á»•i, ta cáº§n phiÃªn báº£n Ä‘á»ƒ API cÅ© váº«n cháº¡y tá»‘t. CÃ¡c cÃ¡ch hay dÃ¹ng:

1. **URL Versioning:** `/api/v1/users` (dá»… hiá»ƒu nháº¥t).
2. **Header Versioning:** `Accept: application/vnd.api+json;version=1`.
3. **Query Parameter Versioning:** `/api/users?version=1`.

---

### **V. Báº¢O Máº¬T (Cá»°C KÃŒ QUAN TRá»ŒNG!)**

1. **XÃ¡c thá»±c (Authentication):**

    * XÃ¡c Ä‘á»‹nh ai Ä‘ang dÃ¹ng API.
    * **OAuth 2.0:** Cho cÃ¡c app cÃ³ nhiá»u bÃªn tham gia.
    * **JWT (JSON Web Tokens):** Token nhá» gá»n, dá»… xÃ i.

2. **á»¦y quyá»n (Authorization):**

    * Quy Ä‘á»‹nh xem ai Ä‘Æ°á»£c lÃ m gÃ¬.
    * **RBAC (Role-Based Access Control):** PhÃ¢n quyá»n theo vai trÃ² (admin, user).
    * **ABAC (Attribute-Based Access Control):** PhÃ¢n quyá»n dá»±a vÃ o thuá»™c tÃ­nh (tuá»•i, vá»‹ trÃ­).

---

### **VI. CHáº¶N "NGHáº¼N Máº CH" (RATE LIMITING)**

* Giá»›i háº¡n sá»‘ láº§n gá»i API trong 1 khoáº£ng thá»i gian Ä‘á»ƒ trÃ¡nh bá»‹ "táº¥n cÃ´ng".
* **VÃ­ dá»¥ header:**
    * `X-RateLimit-Limit`: Giá»›i háº¡n sá»‘ láº§n gá»i.
    * `X-RateLimit-Remaining`: Sá»‘ láº§n cÃ²n láº¡i.
    * `X-RateLimit-Reset`: Thá»i gian reset láº¡i giá»›i háº¡n.

---

### **VII. TÃ€I LIá»†U API (Cáº¨N THáº¬N LÃ€M GÃŒ CÅ¨NG Tá»T!)**

* **CÃ´ng cá»¥:** Swagger, Postman, OpenAPI.
* **Ná»™i dung cáº§n cÃ³:**
    * MÃ´ táº£ endpoint, request/response máº«u.
    * Giáº£i thÃ­ch mÃ£ lá»—i.
    * SDK hoáº·c code máº«u cho cÃ¡c ngÃ´n ngá»¯.

---

### **VIII. Xá»¬ LÃ Lá»–I (HÆ¯á»šNG DáºªN Cá»¤ THá»‚)**

* **Äá»‹nh dáº¡ng lá»—i:** Tráº£ vá» JSON:

```json
{
  "error": {
    "code": "INVALID_PARAMETER",
    "message": "Tham sá»‘ 'email' khÃ´ng há»£p lá»‡",
    "details": {
      "field": "email",
      "reason": "Sai Ä‘á»‹nh dáº¡ng"
    }
  }
}
```

* **MÃ£ tráº¡ng thÃ¡i HTTP chuáº©n:** NhÆ° Ä‘Ã£ nÃ³i á»Ÿ trÃªn.

---

### **IX. VÃ Dá»¤ CODE C# (CHO Dá»„ HÃŒNH DUNG)**

Giáº£ sá»­ ta cÃ³ 1 model `User`:

```csharp
public class User
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Email { get; set; }
}
```

VÃ­ dá»¥ API láº¥y danh sÃ¡ch user báº±ng C# (ASP.NET Core):

```csharp
using Microsoft.AspNetCore.Mvc;
using System.Collections.Generic;
using System.Linq;

[ApiController]
[Route("api/[controller]")]
public class UsersController : ControllerBase
{
    private static List<User> _users = new List<User> {
        new User { Id = 1, Name = "John Doe", Email = "john.doe@example.com" },
        new User { Id = 2, Name = "Jane Smith", Email = "jane.smith@example.com" }
    };

    [HttpGet]
    public IActionResult GetUsers([FromQuery] int page = 1, [FromQuery] int limit = 10)
    {
       var paginatedUsers = _users
                           .Skip((page - 1) * limit)
                           .Take(limit)
                           .ToList();

        var response = new {
                data = paginatedUsers,
                total = _users.Count(),
                page = page,
                limit = limit
        };

        return Ok(response);
    }

    [HttpGet("{id}")]
    public IActionResult GetUser(int id)
    {
        var user = _users.FirstOrDefault(u => u.Id == id);
        if (user == null)
        {
            return NotFound(); // Tráº£ vá» 404 náº¿u khÃ´ng tÃ¬m tháº¥y
        }
        return Ok(user); // Tráº£ vá» 200 náº¿u tÃ¬m tháº¥y
    }

    [HttpPost]
    public IActionResult CreateUser([FromBody] User newUser)
    {
      _users.Add(newUser);
      return CreatedAtAction(nameof(GetUser), new { id = newUser.Id }, newUser); // Tráº£ vá» 201
    }

    [HttpPut("{id}")]
    public IActionResult UpdateUser(int id, [FromBody] User updatedUser)
    {
        var user = _users.FirstOrDefault(u => u.Id == id);
        if (user == null) return NotFound();
        user.Name = updatedUser.Name;
        user.Email = updatedUser.Email;
        return NoContent(); // Tráº£ vá» 204 náº¿u cáº­p nháº­t thÃ nh cÃ´ng
    }
    
    [HttpDelete("{id}")]
    public IActionResult DeleteUser(int id)
    {
          var user = _users.FirstOrDefault(u => u.Id == id);
         if (user == null) return NotFound();
         _users.Remove(user);
          return NoContent();
     }
}
```

**Giáº£i thÃ­ch:**

* `[ApiController]`: ÄÃ¡nh dáº¥u class nÃ y lÃ  Controller API.
* `[Route("api/[controller]")]`: Äá»‹nh tuyáº¿n cho API.
* `[HttpGet]`, `[HttpPost]`, `[HttpPut]`, `[HttpDelete]`: Äá»‹nh nghÄ©a HTTP method.
* `IActionResult`: Tráº£ vá» káº¿t quáº£ cho client.
* `FromQuery`: Láº¥y tham sá»‘ tá»« query string (`page`, `limit`).
* `FromBody`: Láº¥y dá»¯ liá»‡u tá»« body request (JSON).
* `Ok()`, `NotFound()`, `Created()`, `NoContent()`: Tráº£ vá» HTTP status code tÆ°Æ¡ng á»©ng.

---

### **X. QUY TRÃŒNH THIáº¾T Káº¾ API**

1. XÃ¡c Ä‘á»‹nh yÃªu cáº§u: Chá»©c nÄƒng API lÃ m gÃ¬?
2. Thiáº¿t káº¿ tÃ i nguyÃªn vÃ  endpoint: DÃ¹ng HTTP method nÃ o? URL ra sao?
3. PhÃ¡t triá»ƒn API vÃ  tÃ i liá»‡u: Code API + viáº¿t tÃ i liá»‡u.
4. Kiá»ƒm thá»­: Test API tháº­t kÄ©.
5. Triá»ƒn khai vÃ  giÃ¡m sÃ¡t: ÄÆ°a API lÃªn server + theo dÃµi hoáº¡t Ä‘á»™ng.

---

### **Káº¾T LUáº¬N**

Thiáº¿t káº¿ API khÃ´ng khÃ³, chá»‰ cáº§n náº¯m vá»¯ng nguyÃªn táº¯c vÃ  thá»±c hÃ nh nhiá»u. ChÃºc cÃ¡c báº¡n code API thÃ nh cÃ´ng vÃ  trá»Ÿ thÃ nh
nhá»¯ng dev pro nhÃ©! CÃ³ gÃ¬ tháº¯c máº¯c cá»© há»i, mÃ¬nh luÃ´n sáºµn sÃ ng giÃºp Ä‘á»¡! ğŸ’ª
