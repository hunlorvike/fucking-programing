## **üî• T√ÄI LI·ªÜU SI√äU C·∫§P THI·∫æT K·∫æ API CHO H·ªÜ TH·ªêNG CMS (D√ÄNH CHO D√ÇN CODE)** üî•

Hello c√°c b·∫°n sinh vi√™n IT! H√¥m nay ch√∫ng ta s·∫Ω c√πng nhau "m·ªï x·∫ª" c√°ch thi·∫øt k·∫ø API cho m·ªôt h·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung (
CMS). Nghe c√≥ v·∫ª "khoai" nh∆∞ng th·ª±c ra r·∫•t th√∫ v·ªã v√† h·ªØu √≠ch ƒë·∫•y. M√¨nh s·∫Ω c·ªë g·∫Øng gi·∫£i th√≠ch d·ªÖ hi·ªÉu nh·∫•t c√≥ th·ªÉ, k√®m
theo v√≠ d·ª• tr·ª±c quan ƒë·ªÉ c√°c b·∫°n d·ªÖ "nu·ªët" nh√©. Let's go!

### **1. T·ªîNG QUAN: T·∫†I SAO C·∫¶N API CHO CMS?**

* **CMS (Content Management System):** L√† h·ªá th·ªëng gi√∫p b·∫°n qu·∫£n l√Ω n·ªôi dung (b√†i vi·∫øt, h√¨nh ·∫£nh, video) tr√™n website.
  V√≠ d·ª•: WordPress, Joomla, Drupal.
* **API:** L√† "c·∫ßu n·ªëi" gi√∫p c√°c ·ª©ng d·ª•ng "n√≥i chuy·ªán" v·ªõi CMS. Thay v√¨ l√†m m·ªçi th·ª© tr√™n giao di·ªán web, b·∫°n c√≥ th·ªÉ d√πng
  API ƒë·ªÉ t·ª± ƒë·ªông h√≥a c√°c t√°c v·ª•.
* **V√≠ d·ª•:**
    * ·ª®ng d·ª•ng mobile l·∫•y danh s√°ch b√†i vi·∫øt t·ª´ CMS.
    * ·ª®ng d·ª•ng kh√°c t·ª± ƒë·ªông ƒëƒÉng b√†i l√™n CMS.
    * ·ª®ng d·ª•ng ph√¢n t√≠ch d·ªØ li·ªáu l·∫•y th√¥ng tin ng∆∞·ªùi d√πng t·ª´ CMS.

**M·ª•c ti√™u c·ªßa API:**

* **D·ªÖ d√πng:** Ai c≈©ng c√≥ th·ªÉ t√≠ch h·ª£p, kh√¥ng c·∫ßn ph·∫£i l√† chuy√™n gia CMS.
* **M·∫°nh m·∫Ω:** L√†m ƒë∆∞·ª£c m·ªçi th·ª© b·∫°n c·∫ßn tr√™n CMS.
* **An to√†n:** B·∫£o v·ªá d·ªØ li·ªáu c·ªßa b·∫°n.
* **Linh ho·∫°t:** D·ªÖ d√†ng thay ƒë·ªïi, n√¢ng c·∫•p.

### **2. C·∫§U TR√öC URL (ƒê·ªäA CH·ªà C·ª¶A API)**

* **Base URL:** `https://api.ourcms.com/api/v1` (gi·ªëng nh∆∞ "ƒë·ªãa ch·ªâ nh√†" c·ªßa API).
* **T√†i nguy√™n (Resources):** C√°c "ƒë·ªëi t∆∞·ª£ng" m√† API qu·∫£n l√Ω:
    * `/articles`: Qu·∫£n l√Ω b√†i vi·∫øt.
    * `/categories`: Qu·∫£n l√Ω danh m·ª•c.
    * `/users`: Qu·∫£n l√Ω ng∆∞·ªùi d√πng.
    * `/permissions`: Qu·∫£n l√Ω quy·ªÅn.
    * `/media`: Qu·∫£n l√Ω file media (h√¨nh ·∫£nh, video).
    * `/comments`: Qu·∫£n l√Ω b√¨nh lu·∫≠n.
    * `/settings`: C√†i ƒë·∫∑t h·ªá th·ªëng.
    * `/webhooks`: Th√¥ng b√°o s·ª± ki·ªán.

### **3. X√ÅC TH·ª∞C V√Ä ·ª¶Y QUY·ªÄN (B·∫¢O V·ªÜ D·ªÆ LI·ªÜU!)**

* **X√°c th·ª±c (Authentication):** X√°c ƒë·ªãnh xem ai ƒëang d√πng API.
    * **JWT (JSON Web Token):** Gi·ªëng nh∆∞ "v√© v√†o c·ª≠a".
        * Token ƒë∆∞·ª£c g·ª≠i qua header: `Authorization: Bearer <token>`.
        * Ho·∫∑c cookie `access_token`.
        * D√πng refresh token ƒë·ªÉ l·∫•y token m·ªõi.
    * **API Key:** Cho c√°c ·ª©ng d·ª•ng kh√¥ng c·∫ßn x√°c th·ª±c ng∆∞·ªùi d√πng (v√≠ d·ª•: l·∫•y d·ªØ li·ªáu c√¥ng khai).
        * G·ª≠i qua header: `X-API-Key: <api_key>`.
    * **HTTPS:** M·ªçi k·∫øt n·ªëi ƒë·ªÅu ph·∫£i d√πng HTTPS (m√£ h√≥a d·ªØ li·ªáu, an to√†n h∆°n).

* **·ª¶y quy·ªÅn (Authorization):** Quy·∫øt ƒë·ªãnh xem ng∆∞·ªùi d√πng ƒë∆∞·ª£c l√†m g√¨.
    * **RBAC (Role-Based Access Control):** Ph√¢n quy·ªÅn theo vai tr√≤ (admin, editor, author, viewer).
    * **ABAC (Attribute-Based Access Control):** Ph√¢n quy·ªÅn d·ª±a tr√™n thu·ªôc t√≠nh (v√≠ d·ª•: ch·ªâ cho ph√©p ng∆∞·ªùi c√πng ph√≤ng
      ban s·ª≠a b√†i vi·∫øt c·ªßa nhau).

### **4. C√ÅC ENDPOINT CH√çNH (NH·ªÆNG CON ƒê∆Ø·ªúNG D·∫™N ƒê·∫æN D·ªÆ LI·ªÜU)**

M√¨nh s·∫Ω li·ªát k√™ c√°c endpoint ph·ªï bi·∫øn nh·∫•t cho CMS, k√®m theo v√≠ d·ª• d·ªÖ hi·ªÉu:

#### **4.1. QU·∫¢N L√ù B√ÄI VI·∫æT (`/articles`)**

| Method   | URL                       | Ch·ª©c nƒÉng                            | Payload (Request Body)                                                                        |
|----------|---------------------------|--------------------------------------|-----------------------------------------------------------------------------------------------|
| `GET`    | `/articles`               | L·∫•y danh s√°ch b√†i vi·∫øt               | (Query Params): Ph√¢n trang, l·ªçc, s·∫Øp x·∫øp.                                                     |
| `GET`    | `/articles/{id}`          | L·∫•y th√¥ng tin chi ti·∫øt b√†i vi·∫øt      | -                                                                                             |
| `POST`   | `/articles`               | T·∫°o b√†i vi·∫øt m·ªõi                     | `{ title, content, author_id, category_id, tags, status, thumbnail }`.                        |
| `PUT`    | `/articles/{id}`          | C·∫≠p nh·∫≠t to√†n b·ªô b√†i vi·∫øt            | `{ title, content, author_id, category_id, tags, status, thumbnail }`.                        |
| `PATCH`  | `/articles/{id}`          | C·∫≠p nh·∫≠t m·ªôt ph·∫ßn b√†i vi·∫øt           | `{ title?, content?, author_id?, category_id?, tags?, status?, thumbnail? }` (`?`: t√πy ch·ªçn). |
| `DELETE` | `/articles/{id}`          | X√≥a b√†i vi·∫øt                         | -                                                                                             |
| `GET`    | `/articles/{id}/comments` | L·∫•y danh s√°ch b√¨nh lu·∫≠n c·ªßa b√†i vi·∫øt | (Query Params)                                                                                |
| `POST`   | `/articles/{id}/comments` | Th√™m b√¨nh lu·∫≠n v√†o b√†i vi·∫øt          | `{ content, author_id }`.                                                                     |

* **Tr·∫°ng th√°i:** `draft` (nh√°p), `pending` (ch·ªù duy·ªát), `published` (ƒë√£ ƒëƒÉng).

**V√≠ d·ª•:**

* `GET /articles?page=2&limit=10&sort=-created_at`: L·∫•y 10 b√†i vi·∫øt ·ªü trang 2, s·∫Øp x·∫øp theo th·ªùi gian t·∫°o gi·∫£m d·∫ßn.
* `POST /articles`: T·∫°o b√†i vi·∫øt m·ªõi (g·ª≠i k√®m JSON data).

#### **4.2. QU·∫¢N L√ù DANH M·ª§C (`/categories`)**

| Method   | URL                         | Ch·ª©c nƒÉng                   | Payload (Request Body)    |
|----------|-----------------------------|-----------------------------|---------------------------|
| `GET`    | `/categories`               | L·∫•y danh s√°ch danh m·ª•c      | (Query Params)            |
| `GET`    | `/categories/{id}`          | L·∫•y chi ti·∫øt danh m·ª•c       | -                         |
| `POST`   | `/categories`               | T·∫°o danh m·ª•c m·ªõi            | `{ name, description }`   |
| `PUT`    | `/categories/{id}`          | C·∫≠p nh·∫≠t to√†n b·ªô danh m·ª•c   | `{ name, description }`   |
| `PATCH`  | `/categories/{id}`          | C·∫≠p nh·∫≠t m·ªôt ph·∫ßn danh m·ª•c  | `{ name?, description? }` |
| `DELETE` | `/categories/{id}`          | X√≥a danh m·ª•c                | -                         |
| `GET`    | `/categories/{id}/articles` | L·∫•y b√†i vi·∫øt thu·ªôc danh m·ª•c | (Query Params)            |

#### **4.3. QU·∫¢N L√ù NG∆Ø·ªúI D√ôNG (`/users`)**

| Method   | URL                    | Ch·ª©c nƒÉng                    | Payload (Request Body)                                             |
|----------|------------------------|------------------------------|--------------------------------------------------------------------|
| `GET`    | `/users`               | L·∫•y danh s√°ch ng∆∞·ªùi d√πng     | (Query Params)                                                     |
| `GET`    | `/users/{id}`          | L·∫•y chi ti·∫øt ng∆∞·ªùi d√πng      | -                                                                  |
| `POST`   | `/users`               | T·∫°o ng∆∞·ªùi d√πng m·ªõi           | `{ username, password, email, first_name, last_name, role }`       |
| `PUT`    | `/users/{id}`          | C·∫≠p nh·∫≠t to√†n b·ªô ng∆∞·ªùi d√πng  | `{ username?, password?, email?, first_name?, last_name?, role? }` |
| `PATCH`  | `/users/{id}`          | C·∫≠p nh·∫≠t m·ªôt ph·∫ßn ng∆∞·ªùi d√πng | `{ username?, password?, email?, first_name?, last_name?, role? }` |
| `DELETE` | `/users/{id}`          | X√≥a ng∆∞·ªùi d√πng               | -                                                                  |
| `GET`    | `/users/{id}/articles` | L·∫•y b√†i vi·∫øt c·ªßa ng∆∞·ªùi d√πng  | (Query Params)                                                     |

* **Vai tr√≤:** `admin`, `editor`, `author`, `viewer`, ... ho·∫∑c vai tr√≤ t·ª± t·∫°o.

#### **4.4. QU·∫¢N L√ù QUY·ªÄN (`/permissions`)**

| Method   | URL                                 | Ch·ª©c nƒÉng                 | Payload (Request Body)           |
|----------|-------------------------------------|---------------------------|----------------------------------|
| `GET`    | `/permissions`                      | L·∫•y danh s√°ch quy·ªÅn       | (Query Params)                   |
| `GET`    | `/permissions/{id}`                 | L·∫•y chi ti·∫øt quy·ªÅn        | -                                |
| `POST`   | `/permissions`                      | T·∫°o quy·ªÅn m·ªõi             | `{ name, description }`          |
| `PUT`    | `/permissions/{id}`                 | C·∫≠p nh·∫≠t quy·ªÅn            | `{ name, description }`          |
| `PATCH`  | `/permissions/{id}`                 | C·∫≠p nh·∫≠t m·ªôt ph·∫ßn quy·ªÅn   | `{ name?, description? }`        |
| `DELETE` | `/permissions/{id}`                 | X√≥a quy·ªÅn                 | -                                |
| `GET`    | `/users/{id}/permissions`           | L·∫•y quy·ªÅn c·ªßa ng∆∞·ªùi d√πng  | (Query Params)                   |
| `POST`   | `/users/{id}/permissions`           | Th√™m quy·ªÅn cho ng∆∞·ªùi d√πng | `{ permissions_ids: [1, 2, 3] }` |
| `DELETE` | `/users/{id}/permissions/{perm_id}` | X√≥a quy·ªÅn c·ªßa ng∆∞·ªùi d√πng  | -                                |

#### **4.5. QU·∫¢N L√ù MEDIA (`/media`)**

| Method   | URL           | Ch·ª©c nƒÉng           | Payload (Request Body) |
|----------|---------------|---------------------|------------------------|
| `GET`    | `/media`      | L·∫•y danh s√°ch media | (Query Params)         |
| `GET`    | `/media/{id}` | L·∫•y chi ti·∫øt media  | -                      |
| `POST`   | `/media`      | Upload media m·ªõi    | `FormData` (file)      |
| `DELETE` | `/media/{id}` | X√≥a media           | -                      |

#### **4.6. QU·∫¢N L√ù B√åNH LU·∫¨N (`/comments`)**

| Method   | URL              | Ch·ª©c nƒÉng                   | Payload (Request Body)                  |
|----------|------------------|-----------------------------|-----------------------------------------|
| `GET`    | `/comments`      | L·∫•y danh s√°ch b√¨nh lu·∫≠n     | (Query Params)                          |
| `GET`    | `/comments/{id}` | L·∫•y chi ti·∫øt b√¨nh lu·∫≠n      | -                                       |
| `POST`   | `/comments`      | T·∫°o b√¨nh lu·∫≠n m·ªõi           | `{ content, author_id, article_id }`    |
| `PUT`    | `/comments/{id}` | C·∫≠p nh·∫≠t to√†n b·ªô b√¨nh lu·∫≠n  | `{ content, author_id, article_id }`    |
| `PATCH`  | `/comments/{id}` | C·∫≠p nh·∫≠t m·ªôt ph·∫ßn b√¨nh lu·∫≠n | `{ content?, author_id?, article_id? }` |
| `DELETE` | `/comments/{id}` | X√≥a b√¨nh lu·∫≠n               | -                                       |

#### **4.7. QU·∫¢N L√ù C√ÄI ƒê·∫∂T (`/settings`)**

| Method | URL         | Ch·ª©c nƒÉng                         | Payload (Request Body)                                     |
|--------|-------------|-----------------------------------|------------------------------------------------------------|
| `GET`  | `/settings` | L·∫•y to√†n b·ªô c√†i ƒë·∫∑t h·ªá th·ªëng      | -                                                          |
| `PUT`  | `/settings` | C·∫≠p nh·∫≠t to√†n b·ªô c√†i ƒë·∫∑t h·ªá th·ªëng | `{site_name, description, theme, logo, contact_email,...}` |

#### **4.8. QU·∫¢N L√ù WEBHOOKS (`/webhooks`)**

| Method   | URL              | Ch·ª©c nƒÉng              | Payload (Request Body) |
|----------|------------------|------------------------|------------------------|
| `GET`    | `/webhooks`      | L·∫•y danh s√°ch webhooks | (Query Params)         |
| `GET`    | `/webhooks/{id}` | L·∫•y chi ti·∫øt webhook   | -                      |
| `POST`   | `/webhooks`      | ƒêƒÉng k√Ω webhook m·ªõi    | `{ url, events }`      |
| `PUT`    | `/webhooks/{id}` | C·∫≠p nh·∫≠t webhook       | `{ url?, events? }`    |
| `DELETE` | `/webhooks/{id}` | X√≥a webhook            | -                      |

* **S·ª± ki·ªán webhook:** `article.created`, `article.updated`, `article.deleted`, `category.created`, `category.updated`,
  `category.deleted`, `user.registered`, `user.updated`, `comment.created`, `comment.deleted`

### **5. THAM S·ªê TRUY V·∫§N (QUERY PARAMETERS) - L·ªåC D·ªÆ LI·ªÜU**

* `sort`: S·∫Øp x·∫øp (v√≠ d·ª•: `sort=-created_at` - s·∫Øp x·∫øp theo th·ªùi gian t·∫°o gi·∫£m d·∫ßn).
* `filter`: L·ªçc (v√≠ d·ª•: `filter[category_id]=1` - ch·ªâ l·∫•y b√†i vi·∫øt c√≥ `category_id` l√† 1).
* `search`: T√¨m ki·∫øm (v√≠ d·ª•: `search=keyword`).
* `fields`: Ch·ªçn tr∆∞·ªùng tr·∫£ v·ªÅ (v√≠ d·ª•: `fields=id,title,created_at` - ch·ªâ tr·∫£ v·ªÅ 3 tr∆∞·ªùng n√†y).
* `page`: S·ªë trang (v√≠ d·ª•: `page=1`).
* `per_page`: S·ªë b·∫£n ghi m·ªói trang (v√≠ d·ª•: `per_page=20`).
* `status`: L·ªçc theo tr·∫°ng th√°i (v√≠ d·ª•: `status=published`).

**V√≠ d·ª•:**

`GET /articles?sort=-created_at&filter[author]=123&search=API&page=1&per_page=10&fields=id,title,created_at`

### **6. ƒê·ªäNH D·∫†NG PH·∫¢N H·ªíI (JSON)**

* **Th√†nh c√¥ng:**

```json
{
  "data": {
    "id": 1,
    "title": "H∆∞·ªõng d·∫´n API",
    "content": "N·ªôi dung chi ti·∫øt...",
    "author": {
      "id": 123,
      "name": "Nguy·ªÖn VƒÉn A"
    },
    "created_at": "2023-12-01T12:00:00Z"
  },
    "meta": {
        "page": 1,
        "per_page": 10,
        "total": 100
    }
}
```

* **L·ªói:**

```json
{
  "error": {
    "code": "INVALID_PARAMETER",
    "message": "Tham s·ªë 'title' kh√¥ng h·ª£p l·ªá",
    "details": {
      "field": "title",
      "reason": "ƒê·ªô d√†i t·ªëi thi·ªÉu l√† 5 k√Ω t·ª±"
    }
  }
}
```

* **M√£ l·ªói:** D√πng c√°c m√£ l·ªói c√≥ √Ω nghƒ©a: `INVALID_PARAMETER`, `UNAUTHORIZED`, `NOT_FOUND`, `SERVER_ERROR`, ...

### **7. B·∫¢O M·∫¨T (NH·ªö L√ÄM CHO C·∫®N TH·∫¨N)**

* **HTTPS:** B·∫Øt bu·ªôc ph·∫£i d√πng.
* **Validate input:** Ki·ªÉm tra k·ªπ d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë·ªÉ tr√°nh SQL Injection, XSS.
* **Rate Limiting:** Gi·ªõi h·∫°n s·ªë l·∫ßn g·ªçi API trong 1 kho·∫£ng th·ªùi gian ƒë·ªÉ tr√°nh b·ªã "t·∫•n c√¥ng"
    * Header:
        * `X-RateLimit-Limit: 1000` (Y√™u c·∫ßu t·ªëi ƒëa).
        * `X-RateLimit-Remaining: 998` (Y√™u c·∫ßu c√≤n l·∫°i).
        * `X-RateLimit-Reset: 1692000000` (Th·ªùi gian reset).
* **CORS:** Ch·ªâ cho ph√©p c√°c domain ƒë∆∞·ª£c ph√©p g·ªçi API.
* **B·∫£o m·∫≠t password:** Kh√¥ng l∆∞u password d·∫°ng text.
* **CSRF:** D√πng CSRF token n·∫øu c·∫ßn.

### **8. HI·ªÜU SU·∫§T (CH·∫†Y NHANH NH∆Ø CH·ªöP)**

* **Caching:** D√πng `ETag`, `Last-Modified`, `Cache-Control` ƒë·ªÉ cache d·ªØ li·ªáu.
* **N√©n d·ªØ li·ªáu:** D√πng Gzip ho·∫∑c Brotli ƒë·ªÉ gi·∫£m k√≠ch th∆∞·ªõc response.
* **Ph√¢n trang:** Chia nh·ªè d·ªØ li·ªáu khi tr·∫£ v·ªÅ danh s√°ch d√†i.
* **Lazy loading:** Ch·ªâ t·∫£i d·ªØ li·ªáu c·∫ßn thi·∫øt.
* **CDN:** D√πng CDN cho file media.
* **Database indexing:** T·∫°o index cho c√°c c·ªôt th∆∞·ªùng t√¨m ki·∫øm.

### **9. T√ÄI LI·ªÜU API (C·∫¶N THI·∫æT NH∆Ø "C∆†M B·ªÆA")**

* **Swagger/OpenAPI:** T·∫°o t√†i li·ªáu API t∆∞∆°ng t√°c, d·ªÖ d√πng.
* **N·ªôi dung t√†i li·ªáu:**
    * M√¥ t·∫£ endpoint, method, tham s·ªë.
    * V√≠ d·ª• request/response.
    * M√£ l·ªói.
    * H∆∞·ªõng d·∫´n x√°c th·ª±c, ·ªßy quy·ªÅn.
    * V√≠ d·ª• d√πng query params.
* **Postman:** D√πng Postman collection ƒë·ªÉ d·ªÖ test API.

### **10. WEBHOOKS (TH√îNG B√ÅO S·ª∞ KI·ªÜN)**

* Endpoint ƒëƒÉng k√Ω webhook: `/webhooks` (POST).
* S·ª± ki·ªán h·ªó tr·ª£: `article.created`, `article.updated`, `article.deleted`, ...
* Webhook payload: Th√¥ng tin chi ti·∫øt v·ªÅ s·ª± ki·ªán.
* C∆° ch·∫ø retry (th·ª≠ l·∫°i) n·∫øu webhook tr·∫£ v·ªÅ l·ªói.

### **11. M·ªòT S·ªê C√ÇN NH·∫ÆC KH√ÅC**

* **Content Negotiation:** H·ªó tr·ª£ c√°c ƒë·ªãnh d·∫°ng d·ªØ li·ªáu kh√°c (XML, ...).
* **Logging:** Ghi l·∫°i request/response ƒë·ªÉ debug.
* **Gi√°m s√°t API:** Theo d√µi hi·ªáu su·∫•t, l·ªói.
* **Th·ªëng k√™ API:** L·∫•y d·ªØ li·ªáu v·ªÅ c√°ch s·ª≠ d·ª•ng API.
* **I18n:** H·ªó tr·ª£ ƒëa ng√¥n ng·ªØ qua header `Accept-Language`.

### **K·∫æT LU·∫¨N**

Thi·∫øt k·∫ø API cho CMS kh√¥ng h·ªÅ kh√≥ n·∫øu b·∫°n hi·ªÉu r√µ nguy√™n t·∫Øc v√† th·ª±c h√†nh nhi·ªÅu. H√£y nh·ªõ r·∫±ng, m·ªôt API t·ªët l√† API d·ªÖ
d√πng, m·∫°nh m·∫Ω, an to√†n v√† linh ho·∫°t. Hy v·ªçng t√†i li·ªáu n√†y s·∫Ω gi√∫p c√°c b·∫°n "l√™n tay" nhanh ch√≥ng. Ch√∫c c√°c b·∫°n th√†nh
c√¥ng! üòé
